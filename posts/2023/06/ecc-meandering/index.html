<!DOCTYPE html>
<html lang="zh-cn" dir="ltr" class="scroll-smooth" data-default-appearance="light"
  data-auto-appearance="true"><head>
  <meta charset="utf-8" />
  
  <meta http-equiv="content-language" content="zh-cn" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  
  <title>ECC 杂谈：NIST / NSA 后门，Curve25519 &middot; 呓语</title>
  <meta name="title" content="ECC 杂谈：NIST / NSA 后门，Curve25519 &middot; 呓语" />
  
  <meta name="description" content="密码学好难" />
  <meta name="keywords" content="TLS, ECC, " />
  
  
  <link rel="canonical" href="/posts/2023/06/ecc-meandering/" />
  
  
  
  
  
  
  
  
  
  
  <link type="text/css" rel="stylesheet" href="/css/main.bundle.min.67eb0befb1fb57e6528684f3a2ff6e0606a82100504705b66488d54a9f3fda9c2605c9bf3b70163208427288637a7b4d1a168384c1115e417458eae6b44b329c.css"
    integrity="sha512-Z&#43;sL77H7V&#43;ZShoTzov9uBgaoIQBQRwW2ZIjVSp8/2pwmBcm/O3AWMghCcohjentNGhaDhMERXkF0WOrmtEsynA==" />
  
  
  <script type="text/javascript" src="/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js"
    integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj&#43;e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <script defer type="text/javascript" id="script-bundle" src="/js/main.bundle.min.efbf3b6b987689fffaf2d7b73173d2690c0279a04d444b0537a77d7f4ff6e6d493445400cb0cf56bc0f0f123e19f15394e63cae34e67f069bd013dd5c73df56e.js"
    integrity="sha512-7787a5h2if/68te3MXPSaQwCeaBNREsFN6d9f0/25tSTRFQAywz1a8Dw8SPhnxU5TmPK405n8Gm9AT3Vxz31bg==" data-copy="" data-copied=""></script>
  
  
  
  <script src="/lib/zoom/zoom.min.37d2094687372da3f7343a221a470f6b8806f7891aa46a5a03966af7f0ebd38b9fe536cb154e6ad28f006d184b294525a7c4054b6bbb4be62d8b453b42db99bd.js" integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S&#43;Yti0U7QtuZvQ=="></script>
  
  
  
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
  <link rel="manifest" href="/site.webmanifest" />
  
  
  
  
  
  
  
  <meta property="og:url" content="/posts/2023/06/ecc-meandering/">
  <meta property="og:site_name" content="呓语">
  <meta property="og:title" content="ECC 杂谈：NIST / NSA 后门，Curve25519">
  <meta property="og:description" content="密码学好难">
  <meta property="og:locale" content="zh_cn">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-06-03T00:00:00+00:00">
    <meta property="article:modified_time" content="2023-06-03T00:49:00+08:00">
    <meta property="article:tag" content="TLS">
    <meta property="article:tag" content="ECC">

  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="ECC 杂谈：NIST / NSA 后门，Curve25519">
  <meta name="twitter:description" content="密码学好难">

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "博客",
    "name": "ECC 杂谈：NIST \/ NSA 后门，Curve25519",
    "headline": "ECC 杂谈：NIST \/ NSA 后门，Curve25519",
    "description": "密码学好难",
    "abstract": "最近由于工作原因，接触了不少现代计算机密码学知识。想写点东西分享分享，但由于学的都是些皮毛，属于将就能够应用的水平，这里只能写一篇杂谈，闲聊下 ECC 和 25519。",
    "inLanguage": "zh-cn",
    "url" : "\/posts\/2023\/06\/ecc-meandering\/",
    "author" : {
      "@type": "Person",
      "name": "Z10N0110"
    },
    "copyrightYear": "2023",
    "dateCreated": "2023-06-03T00:49:00\u002b08:00",
    "datePublished": "2023-06-03T00:00:00\u002b00:00",
    
    "dateModified": "2023-06-03T00:49:00\u002b08:00",
    
    "keywords": ["TLS","ECC"],
    
    "mainEntityOfPage": "true",
    "wordCount": "775"
  }]
  </script>


  
  
  <meta name="author" content="Z10N0110" />
  
  
  
  <link href="https://github.com/Z10N0110" rel="me" />
  
  
  
  

<script src="/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js" integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj&#43;KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script>






















  
  



  
  
  <meta name="theme-color"/>
  
  
</head>
<body
  class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600">
  <div id="the-top" class="absolute flex self-center">
    <a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
      href="#main-content"><span
        class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>跳过正文</a>
  </div>
  
  
  <div class="min-h-[148px]"></div>
<div class="fixed inset-x-0 pl-[24px] pr-[24px]" style="z-index:100">
  <div id="menu-blur" class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl shadow-2xl"></div>
  <div class="relative max-w-[64rem] ml-auto mr-auto">
    <div style="padding-left:0;padding-right:0;padding-top:2px;padding-bottom:3px"
    class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start space-x-3">
    
    
    
    <div>
        <a href="/" class="flex">
            <span class="sr-only">呓语</span>

            
            <img src="/img/avatar.png" width="256" height="256"
                class="logo max-h-[5rem] max-w-[5rem] object-scale-down object-left nozoom" alt="呓语" />
            

        </a>
    </div>
    
    <div class="flex flex-1 items-center justify-between">
        <nav class="flex space-x-3">

            
            <a href="/" class="text-base font-medium text-gray-500 hover:text-gray-900">呓语</a>
            

        </nav>
        <nav class="hidden md:flex items-center space-x-5 md:ml-12 h-12">

            
            
            
  <a href="/posts/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="">
        博客
    </p>
</a>



            
            
  <a href="/about/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="">
        关于
    </p>
</a>



            
            
  <a href="https://github.com/Z10N0110"  target="_blank"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <span >
        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>

  </span>


    </span>
    
    <p class="text-base font-medium" title="">
        
    </p>
</a>



            
            

            


            
            <button id="search-button" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            


            
            
            <div
                class="ltr:mr-14 rtl:ml-14 flex items-center">
                <button id="appearance-switcher" aria-label="Dark mode switcher" type="button" class="text-base hover:text-primary-600 dark:hover:text-primary-400">
                    <div class="flex items-center justify-center dark:hidden">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                    </div>
                    <div class="items-center justify-center hidden dark:flex">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                    </div>
                </button>
            </div>
            

        </nav>
        <div class="flex md:hidden items-center space-x-5 md:ml-12 h-12">

            <span></span>

            


            
            <button id="search-button-mobile" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            

            
            
            <button id="appearance-switcher-mobile" aria-label="Dark mode switcher" type="button" class="text-base hover:text-primary-600 dark:hover:text-primary-400" style="margin-right:5px">
                <div class="flex items-center justify-center dark:hidden">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                </div>
                <div class="items-center justify-center hidden dark:flex">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                </div>
            </button>
            

        </div>
    </div>
    <div class="-my-2 -mr-2 md:hidden">

        <label id="menu-button" class="block">
            
            <div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">
                

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>

  </span>


            </div>
            <div id="menu-wrapper" style="padding-top:5px;"
                class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50">
                <ul
                    class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl">

                    <li id="menu-close-button">
                        <span
                            class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>

</span>
                    </li>

                    

                    
  <li class="mt-1">
    <a href="/posts/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="">
            博客
        </p>
    </a>
</li>




                    

                    
  <li class="mt-1">
    <a href="/about/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="">
            关于
        </p>
    </a>
</li>




                    

                    
  <li class="mt-1">
    <a href="https://github.com/Z10N0110"  target="_blank"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <div >
            

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>

  </span>


        </div>
        
        <p class="text-bg font-bg" title="">
            
        </p>
    </a>
</li>




                    

                </ul>
                
                

            </div>
        </label>
    </div>
</div>




<script>
    (function () {
        var $mainmenu = $('.main-menu');
        var path = window.location.pathname;
        $mainmenu.find('a[href="' + path + '"]').each(function (i, e) {
            $(e).children('p').addClass('active');
        });
    })();
</script>


  </div>
</div>
<script>
  window.addEventListener('scroll', function (e) {
    var scroll = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;
    var background_blur = document.getElementById('menu-blur');
    background_blur.style.opacity = (scroll / 300);
  });
</script>

  
  <div class="relative flex flex-col grow">
    <main id="main-content" class="grow">
      


<article>
  
  
  
  
  
  
 
  
   
  
 



<div id="hero" class="h-[150px] md:h-[200px]"></div>



    
    <div class="fixed inset-x-0 top-0 h-[800px] single_hero_background nozoom"
    style="background-image:url(/img/background.svg);">
    


    <div class="absolute inset-0 bg-gradient-to-t from-neutral dark:from-neutral-800 to-transparent mix-blend-normal">
    </div>
    <div
        class="absolute inset-0 opacity-60 bg-gradient-to-t from-neutral dark:from-neutral-800 to-neutral-100 dark:to-neutral-800 mix-blend-normal">
    </div>
</div>

<div id="background-blur" class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl"></div>
<script>
    window.addEventListener('scroll', function (e) {
        var scroll = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;
        var background_blur = document.getElementById('background-blur');
        background_blur.style.opacity = (scroll / 300)
    });
</script>

  
  

  <header id="single_header" class="mt-5 max-w-prose">
    
    <ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden">
  
  
    
  
    
  
  <li class="inline hidden">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/"
      >呓语</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

  
  <li class="inline ">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/posts/"
      >博客</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

  
  <li class="inline hidden">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/posts/2023/06/ecc-meandering/"
      >ECC 杂谈：NIST / NSA 后门，Curve25519</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

</ol>


    
    <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
      ECC 杂谈：NIST / NSA 后门，Curve25519
    </h1>
    <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
      





  
  







  





  



  











  



<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2023-06-03T00:49:00&#43;08:00">2023-06-03</time><span class="px-2 text-primary-500">&middot;</span><span>775 字</span><span class="px-2 text-primary-500">&middot;</span><span title="预计阅读">4 分钟</span><span class="px-2 text-primary-500">&middot;</span>


<script type="text/javascript" src="/js/zen-mode.min.63c8a202661f4a2063fdc2706685d668e8ea3da613da2224e9da527e5876e4f53dcac39ab60732626fb4151feae5d430d0cf44731e5d3c726522fcc1519c1547.js" integrity="sha512-Y8iiAmYfSiBj/cJwZoXWaOjqPaYT2iIk6dpSflh25PU9ysOatgcyYm&#43;0FR/q5dQw0M9Ecx5dPHJlIvzBUZwVRw=="></script>

<span class="mb-[2px]">
    <span id="zen-mode-button"
          class="text-lg hover:text-primary-500"
          title=""
          data-title-i18n-disable=""
          data-title-i18n-enable="">
        <span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="50px" height="50px">
    <path fill="currentColor" d="M 12.980469 4 C 9.1204688 4 5.9804688 7.14 5.9804688 11 L 6 26 L 9.9804688 26 L 9.9804688 11 C 9.9804688 9.35 11.320469 8 12.980469 8 L 40.019531 8 C 41.679531 8 43.019531 9.35 43.019531 11 L 43.019531 39 C 43.019531 40.65 41.679531 42 40.019531 42 L 29 42 C 29 43.54 28.420938 44.94 27.460938 46 L 40.019531 46 C 43.879531 46 47.019531 42.86 47.019531 39 L 47.019531 11 C 47.019531 7.14 43.879531 4 40.019531 4 L 12.980469 4 z M 7 28 C 4.794 28 3 29.794 3 32 L 3 42 C 3 44.206 4.794 46 7 46 L 23 46 C 25.206 46 27 44.206 27 42 L 27 32 C 27 29.794 25.206 28 23 28 L 7 28 z M 7 32 L 23 32 L 23.001953 42 L 7 42 L 7 32 z"/>
</svg>
  </span>

</span>
    </span>
</span>
  

  
  
</div>





<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/cryptography/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Cryptography
  </span>
</span>
  </span>
  
  
  
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/tls/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    TLS
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/ecc/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    ECC
  </span>
</span>
  </span>
  
  
  
  
</div>




    </div>

    
    
    
    
    

    

    
      
      

      

      

    

  </header>
  
  <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
    
     <div
      class="order-first lg:ml-auto px-0 lg:order-last ltr:lg:pl-8 rtl:lg:pr-8">
      <div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-[140px]">

         <details open id="TOCView"
  class="toc-right mt-0 overflow-y-scroll overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block">
  <summary
    class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    目录
  </summary>
  <div
    class="min-w-[220px] py-2 border-dotted ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#ecc-简介">ECC 简介</a></li>
    <li><a href="#可疑的-nist-椭圆曲线nsa-的后门劣迹">可疑的 NIST 椭圆曲线，NSA 的后门劣迹</a></li>
    <li><a href="#curve25519x25519ed25519">Curve25519，X25519，Ed25519</a>
      <ul>
        <li><a href="#openssh-中的-25519">OpenSSH 中的 25519</a></li>
        <li><a href="#tls-中的-25519">TLS 中的 25519</a></li>
        <li><a href="#x509-中的-25519">X509 中的 25519</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</details>
<details class="toc-inside mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden">
  <summary
    class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    目录
  </summary>
  <div
    class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#ecc-简介">ECC 简介</a></li>
    <li><a href="#可疑的-nist-椭圆曲线nsa-的后门劣迹">可疑的 NIST 椭圆曲线，NSA 的后门劣迹</a></li>
    <li><a href="#curve25519x25519ed25519">Curve25519，X25519，Ed25519</a>
      <ul>
        <li><a href="#openssh-中的-25519">OpenSSH 中的 25519</a></li>
        <li><a href="#tls-中的-25519">TLS 中的 25519</a></li>
        <li><a href="#x509-中的-25519">X509 中的 25519</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</details>

<script>

  var margin = 200;
  var marginError = 50;

  (function () {
    var $window = $(window);
    var $toc = $('#TOCView');
    var tocHeight = $toc.height();

    function onResize() {
      var windowAndMarginHeight = $window.height() - margin;
      if(tocHeight >= windowAndMarginHeight) {
        $toc.css("overflow-y", "scroll")
        $toc.css("max-height", (windowAndMarginHeight + marginError) + "px")
      } else {
        $toc.css("overflow-y", "hidden")
        $toc.css("max-height", "9999999px")
      }
    }

    $window.on('resize', onResize);
    $(document).ready(onResize);
  })();



  (function () {
    var $toc = $('#TableOfContents');
    if ($toc.length > 0) {
      var $window = $(window);

      function onScroll() {
        var currentScroll = $window.scrollTop();
        var h = $('.anchor');
        var id = "";
        h.each(function (i, e) {
          e = $(e);
          if (e.offset().top - $(window).height()/3 <= currentScroll) {
            id = decodeURIComponent(e.attr('id'));
          }
        });
        var active = $toc.find('a.active');      
        if (active.length == 1 && active.eq(0).attr('href') == '#' + id) return true;

        active.each(function (i, e) {
          
            $(e).removeClass('active');
          
        });
        $toc.find('a[href="#' + id + '"]').addClass('active')
        $toc.find('a[href="#' + id + '"]').parentsUntil('#TableOfContents').each(function (i, e) {
          $(e).children('a').parents('ul').show();          
        });
      }

      $window.on('scroll', onScroll);
      $(document).ready(function () {
        
        onScroll();
      });
    }
  })();


</script>
   </div>
      </div>
      

      <div class="min-w-0 min-h-0 max-w-fit">
        
        


        <div class="article-content max-w-prose mb-20">
          <p>最近由于工作原因，接触了不少现代计算机密码学知识。想写点东西分享分享，但由于学的都是些皮毛，属于将就能够应用的水平，这里只能写一篇杂谈，闲聊下 ECC 和 25519。</p>


<h2 class="relative group">ECC 简介 
    <div id="ecc-%E7%AE%80%E4%BB%8B" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#ecc-%E7%AE%80%E4%BB%8B" aria-label="锚点">#</a>
    </span>        
    
</h2>
<p>现代计算机的安全性离不开公钥密码学，而公钥密码学的基础构建在数学之上。与较为出名的 RSA 加密系统的算法建立在分解两个大素数乘积（因式分解）的困难性上不同，椭圆曲线密码学 <a href="https://en.wikipedia.org/wiki/Elliptic-curve_cryptography" target="_blank">Elliptic-curve cryptography</a>，即 ECC，是建立在求解椭圆曲线离散对数问题的困难度上。其显著的特点是，对比 RSA 来说 ECC 实现同等加密强度所需的密钥长度要小很多，并且所需的算力开销也更小。</p>
<p>基于 ECC 的具体应用主要分布在两方面：</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Digital_signature" target="_blank">数字签名</a> &ndash; 被广泛应用在身份认证、完整性检查等领域</li>
<li><a href="https://en.wikipedia.org/wiki/Key-agreement_protocol" target="_blank">密钥协商</a> &ndash; 用于现代加密通信最关键的部分：在不可信的信道上进行加密密钥的协商</li>
</ul>
<p>而目前世界上较为流行的 ECC 标准又可大致分为两类：</p>
<ul>
<li>由 NIST (美国国家标准与技术研究院) 推荐的多个曲线，定义在 2000 年发布的 <a href="https://csrc.nist.gov/files/pubs/fips/186-2/final/docs/fips186-2.pdf" target="_blank">FIPS 186-2</a> 中</li>
<li>由世界著名的密码学家 <a href="https://en.wikipedia.org/wiki/Daniel_J._Bernstein" target="_blank">Daniel J. Bernstein</a> 在 2006 年发布的 <a href="https://en.wikipedia.org/wiki/Curve25519" target="_blank">25519</a> 曲线</li>
</ul>
<p>由于较早推出，NIST 的曲线得到了广泛的应用。如数字签名算法 <a href="https://en.wikipedia.org/wiki/Elliptic_Curve_Digital_Signature_Algorithm" target="_blank">ECDSA</a> 在 X509 证书标准中的使用，生产出的对象即是现如今正逐步普及的 ECC 证书。</p>
<p>而在像 OpenSSL 等一众开源 TLS 实现中，NIST 的曲线在密钥协商 <a href="https://en.wikipedia.org/wiki/Elliptic-curve_Diffie%E2%80%93Hellman" target="_blank">ECDH</a> 中更是被作为优先选择。</p>
<blockquote>
<p>在很长的一段时间内，NIST Curve P-256 是 OpenSSL ECDH 默认曲线列表中的首选。</p>
</blockquote>
<p>OpenSSL 代码中虽然没有注释说明是 NIST 标准，我们可以自行对 P-256 的 P 简单做个换算看看 Hex 是否一致。</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/posts/2023/06/ecc-meandering/openssl-1-1-n-ec-curve.png"
        alt="ec 曲线的定义代码"
      />
      
    </figure>
</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/posts/2023/06/ecc-meandering/nist-p-256.png"
        alt="NIST 的 P-256 定义"
      />
      
    </figure>
</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/posts/2023/06/ecc-meandering/golang-calc-p-256-hex.png"
        alt="用 Go 打印下 Hex"
      />
      
    </figure>
</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/posts/2023/06/ecc-meandering/golang-calc-p-256-hex-output.png"
        alt="输出结果"
      />
      
    </figure>
</p>
<p>可以发现确实是 NIST 的曲线无疑。</p>


<h2 class="relative group">可疑的 NIST 椭圆曲线，NSA 的后门劣迹 
    <div id="%E5%8F%AF%E7%96%91%E7%9A%84-nist-%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BFnsa-%E7%9A%84%E5%90%8E%E9%97%A8%E5%8A%A3%E8%BF%B9" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E5%8F%AF%E7%96%91%E7%9A%84-nist-%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BFnsa-%E7%9A%84%E5%90%8E%E9%97%A8%E5%8A%A3%E8%BF%B9" aria-label="锚点">#</a>
    </span>        
    
</h2>
<p>从上面 OpenSSL 的代码截图中可以看见，NIST 的 P-256 曲线被叫做 <code>PRIME_256V1</code>. 这个名字其实来自于 1998 年的 <a href="https://safecurves.cr.yp.to/grouper.ieee.org/groups/1363/private/x9-62-09-20-98.pdf" target="_blank">ANSI X9.62 ECDSA</a> 规范，至于为什么 NIST 的曲线参数跟这个 ANSI 规范的一模一样，是因为后来的 NIST 直接使用了这些曲线。那么问题是，这些曲线为何这样定义？它们又是哪里来的？这两个问题至今没有清晰的答案。因为现实就是这些曲线中的 <code>Seed</code> 定义既没有解释或理由，也没有任何连来历信息。但是在各种密码学、计算机圈子内都倾向于一个统一的，合理的猜测 &ndash; 它们是来自于 NSA（美国国家安全局）。</p>
<p>那么，更为重要的灵魂问题是: <strong>它们是否存在弱点或后门？</strong></p>
<p>如果说从这些曲线发布的那天起，对其的质疑 <sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup> 只在小范围专业圈子内传播，到了 2013 年 9 月 6 日在纽约时报网络版上的一篇新闻 <sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup> 披露出的内容则是在公共领域掀起了轩然大波：根据 <code>爱德华·斯诺登</code>（对，就是棱镜门的主角）披露的机密文件显示，NSA 曾经向某密码学算法植入后门并将其通过 NIST 确立为国家标准。虽然文内并未直接披露是什么算法，但却隐晦的描述了这样的一段话：</p>
<blockquote>
<p>Classified N.S.A. memos appear to confirm that the fatal weakness, discovered by two Microsoft cryptographers in 2007, was engineered by the agency. The N.S.A. wrote the standard and aggressively pushed it on the international group, privately calling the effort &ldquo;a challenge in finesse.&rdquo;</p>
</blockquote>
<p>这让业界很快就锁定到了具体的对象，就是早在 2007 年就由两名来自微软的密码学研究专家发现可以被植入后门 <sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup> 的伪随机数生成算法：来自 <code>NIST SP800-90</code> 的 <code>Dual_EC_DRBG</code>.</p>
<p>紧接着在同年的 12 月，路透社更是直接独家爆料出了 NSA 对 RSA 公司进行 <strong>$10 million</strong> 的贿赂，将 <code>Dual_EC_DRBG</code> 作为 RSA 商业产品 <code>Bsafe</code> 中首选的随机数生成算法的事 <sup id="fnref:4"><a href="#fn:4" class="footnote-ref" role="doc-noteref">4</a></sup>。</p>
<p>很快，越来越多的证据都指出 <code>Dual_EC_DRBG</code> 确实存在可能的后门 <sup id="fnref:5"><a href="#fn:5" class="footnote-ref" role="doc-noteref">5</a></sup> <sup id="fnref:6"><a href="#fn:6" class="footnote-ref" role="doc-noteref">6</a></sup>，工业界纷纷开始抛弃 <code>Dual_EC_DRBG</code>，并且随之而来的还有愈演愈烈的对 NIST 曲线的质疑 <sup id="fnref:7"><a href="#fn:7" class="footnote-ref" role="doc-noteref">7</a></sup> <sup id="fnref:8"><a href="#fn:8" class="footnote-ref" role="doc-noteref">8</a></sup> <sup id="fnref:9"><a href="#fn:9" class="footnote-ref" role="doc-noteref">9</a></sup>，可以说从 2013 后，密码学进入了 「后斯诺登时代」，业界急需一个透明、公开、可审查、可持续改进的 ECC 实现来摆脱 NSA 这个&quot;美国老大哥&quot;给出的可疑曲线。</p>


<h2 class="relative group">Curve25519，X25519，Ed25519 
    <div id="curve25519x25519ed25519" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#curve25519x25519ed25519" aria-label="锚点">#</a>
    </span>        
    
</h2>
<p>随着业界对 NIST 椭圆曲线的不信任加剧，原先于 2006 年发布后只在学术界传播的 25519 曲线热度迅速提升，各工业界的软件开始纷纷加入对 25519 曲线的支持。一方面是信任问题，另一方面是 ECC 在工业界使用上存在可能的专利纠纷 <sup id="fnref:10"><a href="#fn:10" class="footnote-ref" role="doc-noteref">10</a></sup>，而 Curve25519 是公共领域的产物，不受任何专利保护 <sup id="fnref:11"><a href="#fn:11" class="footnote-ref" role="doc-noteref">11</a></sup>。</p>
<p>RFC 在 2016 年 1 月 推出的 <a href="https://www.rfc-editor.org/rfc/rfc7748.txt" target="_blank">RFC 7748</a> 明确了在 ECDH 协议中应用 25519 曲线的 <code>X25519</code> 方法，而 <code>Ed25519</code> 则是出现在 2017 年 1 月的 <a href="https://www.rfc-editor.org/rfc/rfc8032.txt" target="_blank">RFC 8032</a> 这个对 <a href="https://en.wikipedia.org/wiki/EdDSA" target="_blank">EdDSA</a> 数字签名算法进行了更加明晰的标准化规范中，可以说自此之后，可疑的 NIST 曲线将会逐步的退出历史舞台。</p>
<p>从理论上说，25519 曲线的优势在于：</p>
<ul>
<li>
<p>没有专利约束</p>
</li>
<li>
<p>公开，透明的参数，可信度高 &ndash; 不像 NIST 的曲线那样存在可疑的、来路不明的 <code>Seed</code></p>
</li>
<li>
<p>实用安全性高，力图通过精心设计的实用性做好安全性防护</p>
<blockquote>
<p>理论上的安全性不等于实际上的安全性，因为不恰当的实现导致的漏洞不在少数 &ndash; 最著名的例子就是索尼的 PS3 <sup id="fnref:12"><a href="#fn:12" class="footnote-ref" role="doc-noteref">12</a></sup> <sup id="fnref:13"><a href="#fn:13" class="footnote-ref" role="doc-noteref">13</a></sup></p>
<p>对于曲线的安全性探究可以参考：<a href="https://safecurves.cr.yp.to/index.html" target="_blank">SafeCurves: choosing safe curves for elliptic-curve cryptography</a></p>
</blockquote>
</li>
<li>
<p>性能优异，计算速度上比 NIST 曲线要快很多，对低算力的硬件更友好</p>
</li>
<li>
<p>公钥长度很短，只有 32 bytes</p>
<blockquote>
<p>按 Go 标准库中给出的算法计算了下，NIST 的各个曲线的公钥长度如下：</p>
<table>
<thead>
<tr>
<th>NIST Curve</th>
<th>Public Key Bytes Length</th>
</tr>
</thead>
<tbody>
<tr>
<td>P-224</td>
<td>57</td>
</tr>
<tr>
<td>P-256</td>
<td>65</td>
</tr>
<tr>
<td>P-384</td>
<td>97</td>
</tr>
<tr>
<td>P-521</td>
<td>133</td>
</tr>
</tbody>
</table>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/posts/2023/06/ecc-meandering/go-std-crypto-elliptic-marshal.png"
        alt="Go 标准库 crypto/elliptic 的 &lt;code&gt;Marshal&lt;/code&gt; 方法"
      />
      
    </figure>
</p>
<p>可以看出 25519 这个公钥长度确实比 NIST 的要短很多。</p>
</blockquote>
</li>
</ul>
<p>IANIX 专门有一个网页列出了使用 25519 曲线的软件/软件库：<a href="https://ianix.com/pub/curve25519-deployment.html" target="_blank">Things that use Curve25519</a>，感兴趣的读者可以自行浏览。</p>
<p>下面简单聊聊几个我个人接触较多的使用了 25519 曲线的领域/软件的情况。</p>


<h3 class="relative group">OpenSSH 中的 25519 
    <div id="openssh-%E4%B8%AD%E7%9A%84-25519" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#openssh-%E4%B8%AD%E7%9A%84-25519" aria-label="锚点">#</a>
    </span>        
    
</h3>
<p>SSH 的密钥协商没有看见使用 ECDH 这个术语，而是直接叫 KEX，即 Key Exchange.</p>
<blockquote>
<p>OpenSSH 可以通过 <code>ssh -Q kex</code> 查看支持的 KEX 算法</p>
<p>想要知道其他不同的 SSH 实现对 KEX 的支持，可以参考这个矩阵：<a href="https://ssh-comparison.quendi.de/comparison/kex.html" target="_blank">Key exchange protocols</a></p>
</blockquote>
<p><a href="https://www.libssh.org/" target="_blank">LibSSH</a> 的 <a href="https://github.com/arisada" target="_blank">Aris Adamantiadis</a> 于 2013 年 9 月 27 日为 LibSSH 的 KEX 添加了 25591 曲线的支持: <a href="https://github.com/libssh/libssh-mirror/commit/4cb6afcbd43ab503d4c3d3054b96a1492605ea8d" target="_blank">kex: implement curve25519-sha256@libssh.org</a>：</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/posts/2023/06/ecc-meandering/libssh-impl-curve-25519-kex.png"
        alt="github 上的仓库镜像"
      />
      
    </figure>
</p>
<blockquote>
<p>是的，就在纽约时报那篇报道之后的同月就完成了，这可能是世界上第一个实现应用 25519 曲线的 SSH 功能库。引用他自己的描述 <sup id="fnref:14"><a href="#fn:14" class="footnote-ref" role="doc-noteref">14</a></sup> 是：</p>
<blockquote>
<p>This algorithm does not rely on NIST-based curves and gives us more security confidence against a possible backdoor in nistp-256 curve.</p>
</blockquote>
</blockquote>
<p>随后这个功能作为 Patch <sup id="fnref:15"><a href="#fn:15" class="footnote-ref" role="doc-noteref">15</a></sup> 被他提交给了 OpenBSD 团队，并且在 2013 年 11 月 3 日进入 OpenBSD 的主线 <a href="https://github.com/openbsd/src/commit/53ee5feaa847990fb0042601bcaa1c2d32c6b316" target="_blank">use curve25519 for default key exchange (curve25519-sha256@libssh.org);</a>：</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/posts/2023/06/ecc-meandering/openbsd-curve-25519-kex-patch.png"
        alt="initial patch from Aris Adamantiadis"
      />
      
    </figure>
</p>
<p>密钥协商的功能有了，剩下的身份认证那块（Host Key 和 User Authentication Key）对 Ed25519 的支持也在同年的 12 月 完成 <a href="https://github.com/openbsd/src/commit/8ffbcf6d17e8775510029e60a52819f50c2b6e51" target="_blank">support ed25519 keys (hostkeys and user identities) using the public …</a>：</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/posts/2023/06/ecc-meandering/openbsd-support-ed25519.png"
        alt="支持 ed25519"
      />
      
    </figure>
</p>
<blockquote>
<p>OpenSSH 可以通过 <code>ssh -Q key</code> 查看支持的 Host / User Authentication Key 列表</p>
<p>想要知道其他不同的 SSH 实现对 Host / User Authentication Key 的支持，可以参考这个矩阵: <a href="https://ssh-comparison.quendi.de/comparison/hostkey.html" target="_blank">Hostkey formats</a></p>
</blockquote>
<p>所有上述的特性都随着 2014 年 1 月 30 日发布的 <a href="https://www.openssh.com/txt/release-6.5" target="_blank">OpenSSH 6.5</a> 到来：</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/posts/2023/06/ecc-meandering/openssh-6.5-25519-feat.png"
        alt="release note"
      />
      
    </figure>
</p>
<blockquote>
<p>OpenBSD 的发布在 <a href="https://www.openbsd.org/55.html" target="_blank">5.5</a>，晚了几个月。</p>
</blockquote>
<p>上面的两类特性分别在 2020 年的 <a href="https://datatracker.ietf.org/doc/html/rfc8709" target="_blank">RFC 8709</a> 和 <a href="https://datatracker.ietf.org/doc/html/rfc8731" target="_blank">RFC 8731</a> 被标准化。8709 描述的是如何在 SSH 协议中使用 EdDSA ，8731 则是 KEX 中对 25519 和 448 的使用。</p>
<blockquote>
<p>但是我看现在 OpenSSH 也没支持 448 曲线 <sup id="fnref:16"><a href="#fn:16" class="footnote-ref" role="doc-noteref">16</a></sup>。</p>
</blockquote>


<h3 class="relative group">TLS 中的 25519 
    <div id="tls-%E4%B8%AD%E7%9A%84-25519" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#tls-%E4%B8%AD%E7%9A%84-25519" aria-label="锚点">#</a>
    </span>        
    
</h3>
<p>从 IANIX 给出的时间线看，在 RFC 7748 正式发布之前，很多 TLS 相关的软件已经根据 RFC 草案等实现了对 25519 的支持。</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/posts/2023/06/ecc-meandering/curve25519-timeline-part.png"
        alt="时间线"
      />
      
    </figure>
</p>
<p>看得出搜索巨人 Google 的动作还算比较迅速，毕竟这是出于 Chromium / Chrome 的现实需求。</p>
<p>从发布声明上看，LibreSSL 的实现（2017-02-01，2.5.1）比它那个兄弟 OpenSSL 还要晚接近半年。虽然这可能是因为 LibreSSL 要从 OpenBSD 扣代码导致的，但实际上 OpenBSD 仓库中的实现就是比 OpenSSL 要更晚 <sup id="fnref:17"><a href="#fn:17" class="footnote-ref" role="doc-noteref">17</a></sup>。</p>
<blockquote>
<p>Libsodium 更晚，在 2017 年 3 月 的 <a href="https://github.com/jedisct1/libsodium/releases/tag/1.0.12" target="_blank">1.0.12</a> 才支持</p>
</blockquote>
<p>Golang 中 TLS 标准库对 X25519 的支持是在 2017 年 2 月发布的 1.8 引入的，见 <a href="https://github.com/golang/go/issues/15298" target="_blank">crypto/tls: support X25519 key exchange</a>。比较神奇的是，从这个 issue 中甚至能发现 Google 内部在 2015 年 12 月对 BoringSSL 做测试时使用的是 Go 代码，即当时就已做到用 Go 实现了 X25519。</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/posts/2023/06/ecc-meandering/boringssl-golang-testing.png"
        alt="注意 commit 时间"
      />
      
    </figure>
</p>


<h3 class="relative group">X509 中的 25519 
    <div id="x509-%E4%B8%AD%E7%9A%84-25519" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#x509-%E4%B8%AD%E7%9A%84-25519" aria-label="锚点">#</a>
    </span>        
    
</h3>
<p>2018 年 8 月发布的 <a href="https://www.rfc-editor.org/rfc/rfc8410.txt" target="_blank">RFC 8410</a> 中正式将 EdDSA 运用在 X509 中，同时也对 RFC 7748 中定义的 X25519 补充了下 ASN.1 的 OID 等信息。可能读者会奇怪：X25519 不是 ECDH 协议使用的算法吗，怎么会有 ASN.1 的定义？原因在于这个 RFC 标准中还有一个比较奇怪的用法: 将 X25519 的公钥签名后放在证书的结构中，所以才需要定义 X25519 的 OID。不过我也没太搞明白具体的用法和意义，网上的资料也相对较少 <sup id="fnref:18"><a href="#fn:18" class="footnote-ref" role="doc-noteref">18</a></sup>。</p>
<p>OpenSSL 倒是在同年 9 月 20 日发布的 1.1.1 正式版 <sup id="fnref:19"><a href="#fn:19" class="footnote-ref" role="doc-noteref">19</a></sup> <sup id="fnref:20"><a href="#fn:20" class="footnote-ref" role="doc-noteref">20</a></sup> 中支持了 EdDSA 签名的证书，但是截止目前（文章编写时），现实世界中的可信 CA 组织普遍都<strong>不支持</strong>签发使用 Ed25519 签名方案的证书。</p>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>在 Google Groups 上的 <code>sci.crypt</code> Usenet 讨论存档 <a href="https://groups.google.com/g/sci.crypt/c/mFMukSsORmI/m/FpbHDQ6hM_MJ" target="_blank">NIST annouces set of Elliptic Curves</a>&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p><a href="https://www.nytimes.com/2013/09/06/us/nsa-foils-much-internet-encryption.html" target="_blank">N.S.A. Able to Foil Basic Safeguards of Privacy on Web</a>&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:3">
<p><a href="https://rump2007.cr.yp.to/15-shumow.pdf" target="_blank">On the Possibility of a Back Door in the NIST SP800-90 Dual Ec Prng</a>&#160;<a href="#fnref:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:4">
<p><a href="https://www.reuters.com/article/idUSBRE9BJ1C5/" target="_blank">Exclusive: Secret contract tied NSA and security industry pioneer</a>&#160;<a href="#fnref:4" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:5">
<p><a href="https://csrc.nist.gov/csrc/media/projects/crypto-standards-development-process/documents/dualec_in_x982_and_sp800-90.pdf" target="_blank">Dual EC in X9.82 and SP 800-90</a>&#160;<a href="#fnref:5" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:6">
<p>YouTube 视频 <a href="https://www.youtube.com/watch?v=ulg_AHBOIQU&amp;ab_channel=Numberphile" target="_blank">How did the NSA hack our emails?</a>&#160;<a href="#fnref:6" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:7">
<p><a href="https://credelius.com/credelius/?p=97" target="_blank">Why I don’t Trust NIST P-256</a>&#160;<a href="#fnref:7" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:8">
<p><a href="https://fooolix.blogspot.com/2015/11/a-fail.html" target="_blank">A+ Fail</a>&#160;<a href="#fnref:8" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:9">
<p><a href="https://nikmav.blogspot.com/2016/05/gnutls-3-5-0.html" target="_blank">An overview of the new features in GnuTLS 3.5.0</a>&#160;<a href="#fnref:9" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:10">
<p><a href="https://en.wikipedia.org/wiki/ECC_patents" target="_blank">ECC patents</a>&#160;<a href="#fnref:10" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:11">
<p><a href="https://cr.yp.to/ecdh/patents.html" target="_blank">Irrelevant patents on elliptic-curve cryptography</a>&#160;<a href="#fnref:11" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:12">
<p><a href="https://fahrplan.events.ccc.de/congress/2010/Fahrplan/attachments/1780_27c3_console_hacking_2010.pdf" target="_blank">Console Hacking 2010 - PS3 Epic Fail</a>&#160;<a href="#fnref:12" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:13">
<p><a href="https://www.exophase.com/20540/hackers-describe-ps3-security-as-epic-fail-gain-unrestricted-access/" target="_blank">Hackers Describe PS3 Security As Epic Fail, Gain Unrestricted Access</a>&#160;<a href="#fnref:13" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:14">
<p><a href="https://www.libssh.org/2013/11/03/openssh-introduces-curve25519-sha256libssh-org-key-exchange/" target="_blank">OpenSSH introduces curve25519-sha256@libssh.org key exchange !</a>&#160;<a href="#fnref:14" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:15">
<p><a href="https://lists.mindrot.org/pipermail/openssh-unix-dev/2013-September/031659.html" target="_blank">[PATCH] curve25519-sha256 at libssh.org key exchange proposal</a>&#160;<a href="#fnref:15" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:16">
<p><a href="https://www.openssh.com/specs.html" target="_blank">OpenSSH Specifications</a>&#160;<a href="#fnref:16" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:17">
<p><a href="https://github.com/openbsd/src/commit/0ad90c3e6b15b9b6b8463a8a0f87d70c83a07ef4" target="_blank">Add support for ECDHE with X25519.</a>&#160;<a href="#fnref:17" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:18">
<p>cryptography 项目中的 issue，评论中描述了可能的 X25519 证书用途 <a href="https://github.com/pyca/cryptography/issues/6072" target="_blank">X25519 certificates</a>&#160;<a href="#fnref:18" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:19">
<p>PR #3503 <a href="https://github.com/openssl/openssl/pull/3503" target="_blank">Ed25519 support</a>&#160;<a href="#fnref:19" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:20">
<p><a href="https://github.com/openssl/openssl/commit/06c6d05faea05ced44a580c5a2f8bf38a4f3017a" target="_blank">Add Ed25519 algorithm.</a>&#160;<a href="#fnref:20" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>

          
          
          
        </div>
        
        

        
        

          
      </div>
     
      
      
        
        
          
          
        
      <script>
        var oid = "views_posts\/ecc-meandering\/index.md"
        var oid_likes = "likes_posts\/ecc-meandering\/index.md"
      </script>
      
      
      <script type="text/javascript" src="/js/page.min.0860cf4e04fa2d72cc33ddba263083464d48f67de06114529043cb4623319efed4f484fd7f1730df5abea0e2da6f3538855634081d02f2d6e920b956f063e823.js" integrity="sha512-CGDPTgT6LXLMM926JjCDRk1I9n3gYRRSkEPLRiMxnv7U9IT9fxcw31q&#43;oOLabzU4hVY0CB0C8tbpILlW8GPoIw=="></script>
      
  
    </section>
  <footer class="pt-8 max-w-prose print:hidden">

    
  
    
    
    
      
      
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
      <div class="flex justify-between pt-3">
        <span>
          
            <a class="flex group mr-3" href="/posts/2023/06/golang-x509-skid/">
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Go X.509 标准库中 SKID 的故事</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2023-06-12T00:49:00&#43;08:00">2023-06-12</time>
                  
                </span>
              </span>
            </a>
          
        </span>
        <span>
          
            <a class="flex text-right group ml-3" href="/posts/2022/11/set-specific-dns-nameservers-for-specific-domain-on-macos/">
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >macOS 下让特定域名的解析使用指定的 DNS Nameserver</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2022-11-10T00:49:00&#43;08:00">2022-11-10</time>
                  
                </span>
              </span>
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
            </a>
          
        </span>
      </div>
    </div>
  


    
  </footer>
</article>

      <div id="top-scroller" class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0">
  <a href="#the-top"
    class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
    aria-label="返回顶部" title="返回顶部">
    &uarr;
  </a>
</div>
    </main><footer id="site-footer" class="py-10 print:hidden">
  
  
    
    <nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400">
      <ul class="flex flex-col list-none sm:flex-row">
        
        <li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
          <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href="/tags/"
            title="">
            
            标签
          </a>
        </li>
        
        <li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
          <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href="/categories/"
            title="">
            
            类别
          </a>
        </li>
        
      </ul>
    </nav>
    
  
  <div class="flex items-center justify-between">

    
    
    <p class="text-sm text-neutral-500 dark:text-neutral-400">
      &copy;
      2024
      Z10N0110
    </p>
    

    
    
    <p class="text-xs text-neutral-500 dark:text-neutral-400">
      
      
      由 <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://blowfish.page/" target="_blank" rel="noopener noreferrer">Blowfish</a> 强力驱动
    </p>
    

  </div>
  <script>
    
    mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
      margin: 24,
      background: 'rgba(0,0,0,0.5)',
      scrollOffset: 0,
    })
    
  </script>
  
  
  <script type="text/javascript" src="/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js" integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh&#43;sCQ0E53ghYrxgYqw&#43;0GCRyIEpA=="></script>
  
  
</footer>
<div
  id="search-wrapper"
  class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]"
  data-url="/"
  style="z-index:500"
>
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"
  >
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="搜索"
          tabindex="0"
        />
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="关闭 (Esc)"
      >
        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>


      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

  </div>
</body>

</html>
